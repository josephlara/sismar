<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Tidy SISMA tabular program data • sismar</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Tidy SISMA tabular program data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sismar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/tidy_sop.html">Tidy SISMA tabular program data</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/usaid-mozambique/sismar/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Tidy SISMA tabular program data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/usaid-mozambique/sismar/blob/master/vignettes/tidy_sop.Rmd" class="external-link"><code>vignettes/tidy_sop.Rmd</code></a></small>
      <div class="d-none name"><code>tidy_sop.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="open-rstudio-and-load-packages">Open RStudio and Load Packages<a class="anchor" aria-label="anchor" href="#open-rstudio-and-load-packages"></a>
</h2>
<p>Let’s begin by opening a new RStudio work session. Once a session is
open, create a new R script (File -&gt; New File -&gt; R script) and
load the core R packages needed for tidying SISMA .csv exports. The
Tidyverse is a collection of open-source packages designed for general
data science use. Sismar is a package designed for the specific purpose
of munging and conducting feature engineering for SISMA tabular exports.
Finally, the Glue packages provides functions that allow us to combine
and use string values within code.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://usaid-mozambique.github.io/sismar/">sismar</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glue.tidyverse.org/" class="external-link">glue</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="define-global-variables">Define Global Variables<a class="anchor" aria-label="anchor" href="#define-global-variables"></a>
</h2>
<p>We’ll begin our adventure by coding three values into our global
environment for later use - 1) the calendar year for which data was
downloaded from SISMA; 2) the path to the SISMA .csv export saved on our
local machine; and 3) the path and filename where our processed dataset
will be saved. Note that best practice is to store data and scripts in
specific pre-created R project folder structures. This facilitates
reproducibility and collaboration across users.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">year</span> <span class="op">&lt;-</span> <span class="st">"2024"</span></span>
<span><span class="va">path_hiv_tarv</span> <span class="op">&lt;-</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span><span class="op">(</span><span class="st">"Data/tarv_{year}.csv"</span><span class="op">)</span></span>
<span><span class="va">output_hiv_tarv</span> <span class="op">&lt;-</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span><span class="op">(</span><span class="st">"Dataout/hiv_tarv_{year}.txt"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">path_hiv_tarv</span></span>
<span><span class="co">#&gt; Data/tarv_2024.csv</span></span>
<span><span class="va">output_hiv_tarv</span></span>
<span><span class="co">#&gt; Dataout/hiv_tarv_2024.txt</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="tidy-sisma-dataset">Tidy SISMA Dataset<a class="anchor" aria-label="anchor" href="#tidy-sisma-dataset"></a>
</h2>
<p>Having defined the local path to our SISMA dataset, we can now call
functions from the sismar package to generate a tidy analytical
dataframe. This can be done either by using a combination of sismar
functions called in sequence or by calling a singular wrapper function
and specifying the appropriate arguments. Let’s start with the first,
slightly more verbose, approach.</p>
<div class="section level5">
<h5 id="approach-1-using-sequential-functions">Approach 1: Using Sequential Functions<a class="anchor" aria-label="anchor" href="#approach-1-using-sequential-functions"></a>
</h5>
<p>We’ll start by calling <code>clean_sisma_csv</code> and providing the
function argument that specifies where our downloaded SISMA .csv export
is saved on our local machine. Note that this function is not dependent
on the type of program data contained within the .csv file. This means
that clean_sisma_csv` can be used with any SISMA tabular download. In
the output notice that the data frame’s indicators have been pivoted to
a long format, that a small number of variables have been removed, and
that the names of the pivoted indicators have been modified to be more
machine readable.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clean_sisma_csv.html">clean_sisma_csv</a></span><span class="op">(</span><span class="va">path_hiv_tarv</span><span class="op">)</span></span></code></pre></div>
<p>Next, we’ll call a sismar function to engineer data features that are
encoded in the indicator names created by <code>clean_sisma_csv</code>.
In this use case, we call <code>parse_sisma_hiv_tarv</code>. It’s
important to note that there are numerous types of standard programmatic
data sets that can be generated through saved SISMA reports. This means
that the specific sismar parsing function called for feature engineering
will vary depending on type of programmatic data set provided by the
user. A full list and description of each sismar parsing function is
provided in the sismar <a href="https://usaid-mozambique.github.io/sismar/reference/index.html">package
documentation</a>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/parse_sisma_hiv_tarv.html">parse_sisma_hiv_tarv</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<p>In the parsing function output notice that new variables have been
added to the data frame and that indicator names have been encoded to be
more succinct. This tidy format is perfect for analysis!</p>
</div>
<div class="section level5">
<h5 id="approach-2-using-wrapper-function">Approach 2: Using Wrapper Function<a class="anchor" aria-label="anchor" href="#approach-2-using-wrapper-function"></a>
</h5>
<p>As an alternative to approach 1, sismar also provides a wrapper
function that calls both <code>clean_sisma_csv</code> and
<code>parse_sisma_hiv_tarv</code> (or a similar user-specified parsing
function). This reduces the amount of typing and code required for
producing our final dataset. In this approach, we simply call
<code>process_sisma_csv</code> and provide two required arguments: 1)
The “file” argument that specifies the location of the SISMA .csv export
and; 2) The “type” argument that specifies the programmatic data type
for tidy’ing. A full list of values that can be passed to the “type”
argument can be found in the <code>process_sisma_csv</code> <a href="https://usaid-mozambique.github.io/sismar/reference/process_sisma_csv.html">documentation</a>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/process_sisma_csv.html">process_sisma_csv</a></span><span class="op">(</span>file <span class="op">=</span> <span class="va">path_hiv_tarv</span>, </span>
<span>                        type <span class="op">=</span> <span class="st">"HIV TARV"</span><span class="op">)</span></span></code></pre></div>
<p>Notice the output of this singular wrapper function is identical to
the data frame generated in approach 1! br&lt;&gt;
<code>process_sisma_csv</code> includes one more optional argument that
defines the language of the variable names in the output file. Currently
the only language options are “portuguese” and “english” with the former
defined as the argument default. By defining the argument value as
“english” notice the change in the names of the variable output.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/process_sisma_csv.html">process_sisma_csv</a></span><span class="op">(</span>file <span class="op">=</span> <span class="va">path_hiv_tarv</span>, </span>
<span>                        type <span class="op">=</span> <span class="st">"HIV TARV"</span>,</span>
<span>                        language <span class="op">=</span> <span class="st">"english"</span><span class="op">)</span></span></code></pre></div>
<p>Happy analysis of your new tidy dataset!</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Joe Lara, Karishma Srikanth.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
